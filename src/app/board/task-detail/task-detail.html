<div class="overlay-container">
  <div class="card-wrapper form-slide">
    <div class="card big-card">
      <div class="close-btn" (click)="close.emit()">
        <span class="close-sign">X</span>
      </div>
      <div>
        <div class="">
          <span class="category" [ngClass]="getCategoryClass(selectedTask.category)"> {{ selectedTask.category }}</span>
        </div>
        <div class="task-detail-title">
          <h3> {{ selectedTask.title }}</h3>
        </div>
        <div class="description">{{ selectedTask.description }} </div>
        <div class="flex column small-gap">
          <div class="flex small-gap">
            <h4>due date:</h4>
            <h5>{{ selectedTask.dueDate }}</h5>
          </div>
          <div class="flex small-gap">
            <h4>Priority:</h4>
            <h5 class="priority-container">
              {{ selectedTask.priority }}
              <span class="priority-icon">
                <img [src]="getPriorityIcon(selectedTask.priority)" [alt]="selectedTask.priority + ' priority'">
              </span>
            </h5>
          </div>
          <div class="flex column basic-gap">
            <div>
              <h4>Assigned to</h4>
            </div>
            <div class="flex column small-gap">
              @if (selectedTask.assignedTo && selectedTask.assignedTo.length > 0) {
                @for (contactId of selectedTask.assignedTo; track contactId) {
                  <div class="flex assigned-to small-gap">
                    <div class="circle-initial">
                      <div class="circle-user" [style.backgroundColor]="getColor(getContactName(contactId))">
                        {{ getInitials(getContactName(contactId)) }}
                      </div>
                    </div>
                    <div class="contact-name">{{ getContactName(contactId) }}</div>
                  </div>
                }
              } @else {
                <div class="no-contacts">No contacts assigned</div>
              }
            </div>
            <div class="flex column basic-gap subtask-container">
              <div class="flex basic-gap">
                <h4>Subtasks:</h4>
              </div>
              @if (selectedTask.subtasks && selectedTask.subtasks.length > 0) {
                @for (subtask of selectedTask.subtasks; track $index) {
                 <div class="checkbox-container">
                    <input class="custom-checkbox" type="checkbox" [checked]="subtask?.done || false" [id]="'subtask-' + $index">
                    <label [for]="'subtask-' + $index" class="label-for-checkbox">
                      {{ subtask?.title || 'Subtask ' + ($index + 1) }}
                    </label>
                  </div> 
                }
              } @else {
                <div class="no-subtasks">No subtasks defined</div>
              }
            </div>
            <div class="edit-delete-section">
          <div class="flex row button-group">
                <div class="iconsbefore edit" (click)="editTasks(selectedTask)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" class="icon-edit" viewBox="0 0 19 19"
                    fill="none">
                    <path
                      d="M2 17H3.4L12.025 8.375L10.625 6.975L2 15.6V17ZM16.3 6.925L12.05 2.725L13.45 1.325C13.8333 0.941667 14.3042 0.75 14.8625 0.75C15.4208 0.75 15.8917 0.941667 16.275 1.325L17.675 2.725C18.0583 3.10833 18.2583 3.57083 18.275 4.1125C18.2917 4.65417 18.1083 5.11667 17.725 5.5L16.3 6.925ZM14.85 8.4L4.25 19H0V14.75L10.6 4.15L14.85 8.4Z" />
                  </svg>
                  <h4>Edit</h4>
                </div>
                <div class="iconsbefore delete" (click)="promptDelete(selectedTask.id!)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="17" height="18" class="icon-edit" viewBox="0 0 17 18">
                    <path
                      d="M3.5 18C2.95 18 2.47917 17.8042 2.0875 17.4125C1.69583 17.0208 1.5 16.55 1.5 16V3C1.21667 3 0.979167 2.90417 0.7875 2.7125C0.595833 2.52083 0.5 2.28333 0.5 2C0.5 1.71667 0.595833 1.47917 0.7875 1.2875C0.979167 1.09583 1.21667 1 1.5 1H5.5C5.5 0.716667 5.59583 0.479167 5.7875 0.2875C5.97917 0.0958333 6.21667 0 6.5 0H10.5C10.7833 0 11.0208 0.0958333 11.2125 0.2875C11.4042 0.479167 11.5 0.716667 11.5 1H15.5C15.7833 1 16.0208 1.09583 16.2125 1.2875C16.4042 1.47917 16.5 1.71667 16.5 2C16.5 2.28333 16.4042 2.52083 16.2125 2.7125C16.0208 2.90417 15.7833 3 15.5 3V16C15.5 16.55 15.3042 17.0208 14.9125 17.4125C14.5208 17.8042 14.05 18 13.5 18H3.5ZM3.5 3V16H13.5V3H3.5ZM5.5 13C5.5 13.2833 5.59583 13.5208 5.7875 13.7125C5.97917 13.9042 6.21667 14 6.5 14C6.78333 14 7.02083 13.9042 7.2125 13.7125C7.40417 13.5208 7.5 13.2833 7.5 13V6C7.5 5.71667 7.40417 5.47917 7.2125 5.2875C7.02083 5.09583 6.78333 5 6.5 5C6.21667 5 5.97917 5.09583 5.7875 5.2875C5.59583 5.47917 5.5 5.71667 5.5 6V13ZM9.5 13C9.5 13.2833 9.59583 13.5208 9.7875 13.7125C9.97917 13.9042 10.2167 14 10.5 14C10.7833 14 11.0208 13.9042 11.2125 13.7125C11.4042 13.5208 11.5 13.2833 11.5 13V6C11.5 5.71667 11.4042 5.47917 11.2125 5.2875C11.0208 5.09583 10.7833 5 10.5 5C10.2167 5 9.97917 5.09583 9.7875 5.2875C9.59583 5.47917 9.5 5.71667 9.5 6V13Z" />
                  </svg>
                  <h4>Delete</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
    @if (showDeleteConfirm) {
  <div class="delete-confirm-overlay">
    <div class="delete-dialog">
      <h3>Delete contact?</h3>
      <p>Do you realy want to delete this contact?</p>
      <div class="button-group">
        <button class="btn cancel" (click)="cancelDelete()">cancel</button>
        <button class="btn delete" (click)="confirmDelete()">delete</button>
      </div>
    </div>
  </div>
  }
